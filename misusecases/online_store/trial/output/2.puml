@startuml
left to right direction
skinparam backgroundColor #FFFFFF

' --- Global styling ---
skinparam shadowing false
skinparam ArrowColor #333333
skinparam ArrowFontColor #333333
skinparam ArrowFontSize 12

' Use cases (legit)
skinparam usecase {
  BackgroundColor #FFFFFF
  BorderColor #333333
  FontColor #111111
  StereotypeFontColor #111111
}

' Misuse cases (dark with white text + white stereotype)
skinparam usecase<<misuse>> {
  BackgroundColor #2B2B2B
  BorderColor #111111
  FontColor #FFFFFF
  StereotypeFontColor #FFFFFF
}

' Actors (legit)
skinparam actor {
  BackgroundColor #FFFFFF
  BorderColor #333333
  FontColor #111111
}

' Misactors (dark stickman, but label readable on white background)
skinparam actor<<misactor>> {
  BackgroundColor #2B2B2B
  BorderColor #111111
  FontColor #111111
}

' --- Actors OUTSIDE system boundary ---
actor "Customer" as Customer
actor "Fraudster" <<misactor>> as Fraudster
actor "Hacker" <<misactor>> as Hacker

rectangle "Online Store System" as OSS {

  ' --- Regular use cases ---
  usecase "Browse Catalogue" as UC_Browse
  usecase "Place Order" as UC_Order
  usecase "Make Payment" as UC_Pay

  ' --- Security / countermeasure use cases (no stereotype) ---
  usecase "Authenticate User" as UC_Auth
  usecase "Encrypt Communication\n(SSL/TLS)" as UC_TLS
  usecase "Verify Payment Details" as UC_VerifyPay
  usecase "Apply Rate Limiting" as UC_RateLimit

  ' --- Misuse cases ---
  usecase "Place Fraudulent Order" <<misuse>> as MU_FraudOrder
  usecase "Steal Credit Card Data" <<misuse>> as MU_StealCC
  usecase "Denial of Service Attack" <<misuse>> as MU_DoS
  usecase "Impersonate Customer" <<misuse>> as MU_Impersonate

  ' --- Required includes ---
  UC_Order ..> UC_Auth : <<include>>
  UC_Pay ..> UC_TLS : <<include>>

  ' --- Countermeasures (mitigates) ---
  UC_VerifyPay ..> MU_FraudOrder : <<mitigates>>
  UC_TLS ..> MU_StealCC : <<mitigates>>
  UC_RateLimit ..> MU_DoS : <<mitigates>>
  UC_Auth ..> MU_Impersonate : <<mitigates>>

  ' --- Threats (threatens) ---
  MU_FraudOrder ..> UC_Order : <<threatens>>
  MU_StealCC ..> UC_Pay : <<threatens>>

  MU_DoS ..> UC_Order : <<threatens>>
  MU_DoS ..> UC_Browse : <<threatens>>

  MU_Impersonate ..> UC_Order : <<threatens>>
}

' --- Actor associations (directed arrows) ---
Customer --> UC_Browse
Customer --> UC_Order
Customer --> UC_Pay

Fraudster --> MU_FraudOrder
Hacker --> MU_StealCC
Hacker --> MU_DoS
Hacker --> MU_Impersonate

@enduml